---
title: Mimikatz::Net
description: Net module reference
published: true
date: 2025-10-08T16:36:37.853Z
tags: mimikatz
editor: markdown
dateCreated: 2025-10-08T16:36:37.853Z
---

# Mimikatz::Net

`net` Module Reference

The `net` module exposes Mimikatz helpers for enumerating Windows networking primitives such as users, groups, sessions, trusts, and delegation configuration. Each command is invoked from the Mimikatz console as `net::<command>`.

Most commands accept an optional positional argument (`net::<command> <server>`) that is passed directly to the corresponding Windows API. When provided, the remote machine (for example `\\FILESERVER`) is queried; when omitted, the local host is inspected.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L39-L148】【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L387-L466】【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L522-L574】

| Command | Purpose | Notable options |
| --- | --- | --- |
| `net::user` | Enumerate users, group memberships, and alias memberships from the SAM database. | Positional `<server>` |
| `net::group` | List domain groups and their members. | Positional `<server>` |
| `net::alias` | Inspect alias (local group) memberships. | Positional `<server>` |
| `net::session` | List active SMB/NetBIOS sessions. | Positional `<server>` |
| `net::wsession` | Show users logged on via Workstation service. | Positional `<server>` |
| `net::tod` | Retrieve the remote time-of-day. | Positional `<server>` |
| `net::stats` | Dump workstation service statistics. | Positional `<server>` |
| `net::share` | Enumerate shared resources. | Positional `<server>` |
| `net::serverinfo` | Display server role, version, and comment metadata. | Positional `<server>` |
| `net::trust` | Enumerate AD domain trusts via RPC and LDAP. | `/server:<dc>` |
| `net::deleg` | Audit delegation-enabled principals in Active Directory. | `/server:<dc>`, `/dns` |
| `net::if` | Query DCOM endpoint mapper interfaces. | Positional `<server>` |

## Command Details

### `net::user`
- **Usage:** `net::user [\\server]`
- **What it does:** Connects to the target SAM server, enumerates every domain in the database, and prints each user account alongside its global group memberships and alias memberships (including Builtin aliases).【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L39-L148】
- **Why use it:** Useful for quickly understanding effective group membership and privilege inheritance for user principals, especially when targeting remote domain controllers or member servers via the optional server parameter.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L39-L148】

### `net::group`
- **Usage:** `net::group [\\server]`
- **What it does:** Enumerates each domain, lists all groups, and prints the relative IDs and resolved names for every member by querying the SAM database directly.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L160-L233】
- **Why use it:** Provides a complete snapshot of group membership without relying on LDAP, which helps when auditing nested groups or when LDAP access is restricted but SAM RPC is available.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L160-L233】

### `net::alias`
- **Usage:** `net::alias [\\server]`
- **What it does:** Enumerates alias objects (local groups), opens each alias, and displays the SIDs of every member, covering both domain and local principals.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L235-L315】
- **Why use it:** Alias membership often governs local administrative rights; reviewing it via RPC can reveal delegated access that might be hidden from standard Active Directory group listings.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L235-L315】

### `net::session`
- **Usage:** `net::session [\\server]`
- **What it does:** Wraps `NetSessionEnum` to report active client sessions, including the connecting computer name, username, session duration, and idle time.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L377-L403】
- **Why use it:** Helps identify who is currently connected to a target file server or workstation, which can guide lateral movement or incident response activities.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L377-L403】

### `net::wsession`
- **Usage:** `net::wsession [\\server]`
- **What it does:** Calls `NetWkstaUserEnum` to enumerate users logged on via the Workstation service, returning username, logon domain, logon server, and any other trusted domains.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L405-L434】
- **Why use it:** Complements `net::session` by showing interactive/logon-session data instead of just SMB connections, revealing cached logon contexts or RDP users.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L405-L434】

### `net::tod`
- **Usage:** `net::tod [\\server]`
- **What it does:** Invokes `NetRemoteTOD` to retrieve the target system’s time-of-day information and prints it in local time (with commented logic for boot time if needed).【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L436-L466】
- **Why use it:** Comparing remote and local time helps validate time synchronization before executing Kerberos or certificate attacks that rely on precise clocks.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L436-L466】

### `net::stats`
- **Usage:** `net::stats [\\server]`
- **What it does:** Uses `NetStatisticsGet` against the Workstation service to report when statistics were last reset, a proxy for machine uptime or service availability.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L469-L483】
- **Why use it:** Knowing when workstation statistics started can indicate reboots or service disruptions, informing operational planning or forensics timelines.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L469-L483】

### `net::share`
- **Usage:** `net::share [\\server]`
- **What it does:** Enumerates share definitions via `NetShareEnum`, showing the share name, type (with decoded flags), usage limits, and backing path.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L485-L542】
- **Why use it:** Mapping available shares (and their characteristics such as IPC, disk, or temporary) is critical for privilege escalation and data discovery. The decoded flags highlight hidden or administrative shares worth further inspection.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L485-L542】

### `net::serverinfo`
- **Usage:** `net::serverinfo [\\server]`
- **What it does:** Calls `NetServerGetInfo` level 102 to display the server’s platform ID, OS version, comment, and role flags decoded into human-readable roles (workstation, domain controller, DFS, etc.).【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L552-L575】
- **Why use it:** Quickly identifies the type of machine you are targeting (e.g., DC vs. member server) and any published comments that might disclose business context or function.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L552-L575】

### `net::trust`
- **Usage:** `net::trust [/server:<dc>]`
- **What it does:** First leverages `DsEnumerateDomainTrusts` to list trust relationships (including flags, direction, type, SID, and GUID). It then performs an LDAP query against the same domain controller to pull attributes such as trust partner, flat name, direction, and type, decoding bit fields for readability.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L593-L738】
- **Why use `/server`:** Pointing the command at a specific domain controller ensures the RPC and LDAP calls query the intended forest or domain, which is essential in multi-forest or segmented environments.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L593-L738】
- **Why run it:** Enumerating trusts reveals transitive paths and external connections that could be leveraged for cross-domain attacks or require monitoring for defense.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L593-L738】

### `net::deleg`
- **Usage:** `net::deleg [/server:<dc>] [/dns]`
- **What it does:** Executes an LDAP search for principals with SPNs and any delegation-related attributes (`msDS-AllowedToDelegateTo`, `msDS-AllowedToActOnBehalfOfOtherIdentity`, unconstrained delegation via `userAccountControl`). When `/dns` is supplied, HTTP SPNs are validated via `DnsQuery_A` to flag names that are not resolvable.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L742-L856】
- **Why use `/server`:** Directs the LDAP bind to a particular domain controller, which is necessary when auditing cross-domain trusts or when the default DC might not expose the desired context.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L742-L769】
- **Why use `/dns`:** Adds immediate feedback on whether published HTTP SPNs have matching DNS A records, helping defenders find misconfigurations and enabling attackers to prioritize exploitable delegation entries.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L818-L835】

### `net::if`
- **Usage:** `net::if [target]`
- **What it does:** Creates an unauthenticated RPC binding to the target’s endpoint mapper (`ncacn_ip_tcp` on port 135) and calls `ServerAlive2` to enumerate registered interface strings returned in the dual-string array.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L860-L892】
- **Why use it:** Quickly inventories exposed DCOM/RPC interfaces, which can hint at remotely accessible services or COM servers worth investigating for lateral movement.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L860-L892】

## Related Notes
- `net::autoda` is present in the source but commented out; it is not exposed via the command table and therefore has no console documentation.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L332-L375】
- Helper routines such as `kuhl_m_net_simpleLookup` resolve RIDs to names, which is why several commands can show friendly labels without additional LDAP queries.【F:mimikatz/mimikatz/modules/kuhl_m_net.c†L317-L331】
