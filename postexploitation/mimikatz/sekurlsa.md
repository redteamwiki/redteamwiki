---
title: Mimikatz::Sekurlsa
description: Sekurlsa module command reference
published: true
date: 2025-10-08T15:16:31.914Z
tags: mimikatz
editor: markdown
dateCreated: 2025-10-08T15:16:31.914Z
---

# Mimikatz::Sekurlsa
Sekurlsa module command reference

## Overview
The sekurlsa module gathers credential material from a live LSASS process or an offline minidump by loading provider-specific parsers. Its command table exposes providers such as MSV, WDigest, Kerberos, CloudAP, TSPKG, SSP, DPAPI, and Credential Manager, as well as helper utilities for pass-the-hash, boot key management, and Kerberos ticket extraction.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L8-L57】

The `sekurlsa::logonPasswords` aggregator walks every registered provider listed above, making it the quickest way to inventory all supported credential formats in the current LSASS context.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L151-L154】 Architecture guards in the command table hide features that only apply on certain builds (for example, LiveSSP and krbtgt helpers are disabled on ARM64 where domain controllers are not supported).【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L13-L31】

## Command reference
Each subsection summarizes what the command collects, available switches, and why you might use each option.

### `sekurlsa::process`
* **Purpose:** Reset the module to target the live LSASS process again, clearing any cached handles or minidump state.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L112-L116】 Use it after working against a minidump to avoid reading from the wrong handle.
* **Flags:** None.

### `sekurlsa::minidump <path>`
* **Purpose:** Reinitializes the module to read credentials from the supplied LSASS minidump file instead of the live process.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L119-L129】
* **Arguments:** `<path>` is required; without it, the command errors out. Supplying the path lets you investigate offline dumps while keeping the original live context intact.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L121-L129】

### `sekurlsa::msv`
* **Purpose:** Enumerates MSV1_0 logon credentials (LM/NTLM hashes, SHA1, DPAPI flags) from `lsasrv.dll` by iterating the MSV credential structures for each logon session.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_msv1_0.c†L12-L118】
* **Flags:** None.

### `sekurlsa::wdigest`
* **Purpose:** Reads cached clear-text WDigest credentials by walking the WDigest logon list and printing any primary credential blocks found for the session’s LUID.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_wdigest.c†L39-L70】
* **Flags:** None.

### `sekurlsa::kerberos`
* **Purpose:** Dumps Kerberos primary credentials (including smart card PIN data where available) for each logon session by calling the Kerberos package enumerator.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L346-L395】
* **Flags:** None.

### `sekurlsa::tspkg`
* **Purpose:** Extracts Terminal Services single sign-on credentials by traversing the TS global credential table and formatting the stored username/domain/password tuple.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_tspkg.c†L33-L68】
* **Flags:** None.

### `sekurlsa::livessp`
* **Availability:** Disabled on ARM64 builds because the package is not present there.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L13-L15】
* **Purpose:** Parses LiveSSP cached credentials when running on supported architectures by walking the LiveSSP linked list for each logon session.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_livessp.c†L20-L51】
* **Flags:** None.

### `sekurlsa::cloudap`
* **Purpose:** Displays Azure AD Primary Refresh Token (PRT) material and related key GUIDs by dereferencing the CloudAP cache for the active logon session.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_cloudap.c†L20-L119】 This is useful when you need cloud token data for token replay or offline analysis.
* **Flags:** None.

### `sekurlsa::ssp`
* **Purpose:** Lists credentials cached by third-party SSPs registered with the MSV package, showing username, domain, and password fields where present.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_ssp.c†L33-L66】
* **Flags:** None.

### `sekurlsa::logonPasswords`
* **Purpose:** Aggregates the output of every registered sekurlsa provider to show a consolidated credential inventory for all logon sessions.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L151-L154】 Use it when you want a one-shot dump instead of querying each provider individually.
* **Flags:** None.

### `sekurlsa::bootkey`
* **Purpose:** Manage the Secure Kernel boot key cache used to decrypt isolated credentials.
* **Flags:**
  * `/flush` — Clears cached candidate keys and resets the current `IumMkPerBoot` value, which you should do when a previous attempt populated the cache with stale data.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L155-L161】
  * `/new:<hex>` — Injects a new 32-byte boot key (hex-encoded) and clears the cache so subsequent decryptions use the supplied value; use this when you already recovered the correct boot key from another source.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L162-L170】
  * `/raw:<path>` — Scans a raw memory image or dump for additional boot key candidates, automatically appending any finds to the cache; handy when you captured RAM separately and need more key guesses.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa_sk.c†L173-L185】

### `sekurlsa::pth`
* **Purpose:** Performs pass-the-hash/key by replacing credential material in an existing logon session or in a newly created net-only logon, then optionally impersonates the patched token.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L883-L1005】
* **Flags/arguments:**
  * `/luid:<value>` — Target an existing logon session by LUID; use this when you know the session you want to modify and do not want to spawn a new process.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L894-L961】
  * `/user:<name>` and `/domain:<name>` — Required together when you want to create a new net-only logon that will be patched; without them, the command warns about missing arguments.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L901-L915】
  * `/run:<program>` — Overrides the default program (`cmd.exe`) that is launched for a new logon, letting you start a specific tool under the forged credentials.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L905-L909】
  * `/impersonate` — After patching a net-only logon, duplicates the token and impersonates it on the current thread, which is useful for pivoting without launching a new process.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L905-L988】
  * `/ntlm:<hash>` or `/rc4:<hash>` — Supplies the 16-byte NTLM hash (RC4 key) to inject; mandatory unless you provide AES keys, because at least one credential material must be replaced.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L946-L1002】
  * `/aes128:<hex>` — Inserts a 128-bit Kerberos key. Only works on Windows 7/2008 R2 and later where AES session keys are supported; use this when targeting Kerberos authentication that relies on AES keys.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L918-L932】
  * `/aes256:<hex>` — Inserts a 256-bit Kerberos key. Like `/aes128`, it is restricted to modern builds (Windows 8.1 / KB2871997 or later) and is necessary when the target service demands AES-256 tickets.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L932-L944】

### `sekurlsa::krbtgt`
* **Availability:** Disabled on ARM64.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L24-L26】
* **Purpose:** Extracts the current and previous krbtgt keys from the KDC service inside LSASS, enabling Golden Ticket forgery or key roll-back analysis.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L471-L489】
* **Flags:** None.

### `sekurlsa::dpapisystem`
* **Purpose:** Locates the DPAPI service’s system credential buffers and prints the machine/user SHA1 components of the DPAPI_SYSTEM secret, which are needed to decrypt system-protected blobs offline.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L629-L682】
* **Flags:** None.

### `sekurlsa::trust`
* **Availability:** Only compiled on x64/ARM64 builds because it navigates KDC internal domain trust lists that do not exist on 32-bit builds.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L28-L31】【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L685-L719】
* **Purpose:** Enumerates KDC domain trust information, including incoming and outgoing trust keys, useful for cross-domain Kerberos investigations.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L694-L719】
* **Flags:** None.

### `sekurlsa::backupkeys`
* **Availability:** x64/ARM64 only (same guard as `trust`).【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L28-L31】
* **Purpose:** Retrieves the preferred and compatibility DPAPI backup keys (the private keys used to decrypt DPAPI master keys).
* **Flags:**
  * `/export` — Passes an export flag into the analyzer so that recovered backup keys are written out, which you need when you want `.pvk`/`.der` output for later DPAPI master key recovery.【F:mimikatz/mimikatz/modules/sekurlsa/kuhl_m_sekurlsa.c†L862-L877】

### `sekurlsa::tickets`
* **Purpose:** Lists every Kerberos ticket for each logon session and, if asked, exports them to disk in `.kirbi` form.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L360-L365】【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L427-L464】
* **Flags:**
  * `/export` — Any argument toggles the export flag (the implementation simply checks whether arguments exist), so using `/export` or similar causes each ticket to be saved to a file. Use it when you plan to replay tickets with other tools or need them for offline analysis.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L360-L365】【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L451-L463】

### `sekurlsa::ekeys`
* **Purpose:** Dumps Kerberos key lists (NTLM, AES, etc.) associated with logon sessions, which helps when you need raw key material rather than tickets.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L368-L372】【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_kerberos.c†L442-L461】
* **Flags:** None.

### `sekurlsa::dpapi`
* **Purpose:** Enumerates cached DPAPI master keys for non-network logon sessions, unprotects them in-memory, and prints both the raw key and SHA1 hash for later vault or credential decryption.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_dpapi.c†L43-L103】
* **Flags:** None.

### `sekurlsa::credman`
* **Purpose:** Walks the Credential Manager structures for each logon session and reveals saved domain credentials, including decrypted passwords when available.【F:mimikatz/mimikatz/modules/sekurlsa/packages/kuhl_m_sekurlsa_credman.c†L8-L93】
* **Flags:** None.